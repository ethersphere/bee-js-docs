(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{168:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=r.a.createContext({}),l=function(e){var t=r.a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=l(e.components);return r.a.createElement(d.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),p=l(n),b=a,f=p["".concat(o,".").concat(b)]||p[b]||u[b]||i;return n?r.a.createElement(f,s(s({ref:t},d),{},{components:n})):r.a.createElement(f,s({ref:t},d))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=b;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var d=2;d<i;d++)o[d]=n[d];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},169:function(e,t,n){"use strict";function a(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}},171:function(e,t,n){"use strict";var a=n(0),r=n(172);t.a=function(){var e=Object(a.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},172:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)(void 0);t.a=r},173:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(171),o=n(169),s=n(55),c=n.n(s),d=37,l=39;t.a=function(e){var t=e.lazy,n=e.block,s=e.defaultValue,p=e.values,u=e.groupId,b=e.className,f=Object(i.a)(),m=f.tabGroupChoices,h=f.setTabGroupChoices,g=Object(a.useState)(s),O=g[0],w=g[1],y=a.Children.toArray(e.children);if(null!=u){var j=m[u];null!=j&&j!==O&&p.some((function(e){return e.value===j}))&&w(j)}var v=function(e){w(e),null!=u&&h(u,e)},N=[];return r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(o.a)("tabs",{"tabs--block":n},b)},p.map((function(e){var t=e.value,n=e.label;return r.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":O===t,className:Object(o.a)("tabs__item",c.a.tabItem,{"tabs__item--active":O===t}),key:t,ref:function(e){return N.push(e)},onKeyDown:function(e){!function(e,t,n){switch(n.keyCode){case l:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case d:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(N,e.target,e)},onFocus:function(){return v(t)},onClick:function(){v(t)}},n)}))),t?Object(a.cloneElement)(y.filter((function(e){return e.props.value===O}))[0],{className:"margin-vert--md"}):r.a.createElement("div",{className:"margin-vert--md"},y.map((function(e,t){return Object(a.cloneElement)(e,{key:t,hidden:e.props.value!==O})}))))}},174:function(e,t,n){"use strict";var a=n(0),r=n.n(a);t.a=function(e){var t=e.children,n=e.hidden,a=e.className;return r.a.createElement("div",{role:"tabpanel",hidden:n,className:a},t)}},64:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return l}));var a=n(3),r=n(7),i=(n(0),n(168)),o=(n(173),n(174),{title:"SOC and Feeds",id:"soc-and-feeds",slug:"/soc-and-feeds",sidebar_label:"SOC and Feeds"}),s={unversionedId:"user-documentation/soc-and-feeds",id:"user-documentation/soc-and-feeds",isDocsHomePage:!1,title:"SOC and Feeds",description:"Swarm provides the ability to store content in content-addressed chunks or Single Owner Chunks (SOC). With single owner chunks, a user can assign arbitrary data to an address and attest chunk integrity with their digital signature.",source:"@site/docs/user-documentation/soc-and-feeds.md",slug:"/soc-and-feeds",permalink:"/docs/soc-and-feeds",editUrl:"https://github.com/ethersphere/bee-js-docs/blob/master/docs/user-documentation/soc-and-feeds.md",version:"current",sidebar_label:"SOC and Feeds",sidebar:"Balls",previous:{title:"Postal Service over Swarm",permalink:"/docs/pss"},next:{title:"Create dApp in React",permalink:"/docs/create-dapp"}},c=[{value:"Single Owner Chunks",id:"single-owner-chunks",children:[{value:"Reading SOCs",id:"reading-socs",children:[]},{value:"Writing SOCs",id:"writing-socs",children:[]}]},{value:"Feeds",id:"feeds",children:[{value:"Topic",id:"topic",children:[]},{value:"Reading feeds",id:"reading-feeds",children:[]},{value:"Writing feeds",id:"writing-feeds",children:[]},{value:"Using feed manifest",id:"using-feed-manifest",children:[]}]}],d={toc:c};function l(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Swarm provides the ability to store content in content-addressed chunks or Single Owner Chunks (SOC). With single owner chunks, a user can assign arbitrary data to an address and attest chunk integrity with their digital signature."),Object(i.b)("p",null,"Feeds are a unique feature of Swarm. They constitute the primary use case for single owner chunks. Developers can use Feeds to version revisions of a mutable resource, indexing sequential updates to a topic, publish the parts to streams, or post consecutive messages in a communication channel. Feeds implement persisted pull-messaging and can also be interpreted as a pub-sub system."),Object(i.b)("p",null,"Because Feeds are built on top of SOCs, their interfaces are somewhat similar and use common concepts."),Object(i.b)("h2",{id:"single-owner-chunks"},"Single Owner Chunks"),Object(i.b)("p",null,"BeeJs calculates a SOC address as the hash of an ",Object(i.b)("inlineCode",{parentName:"p"},"identifier")," and ",Object(i.b)("inlineCode",{parentName:"p"},"owner"),". The ",Object(i.b)("inlineCode",{parentName:"p"},"identifier")," is a 32 bytes long arbitrary data, usually expected as a hex string or a ",Object(i.b)("inlineCode",{parentName:"p"},"Uint8Array"),". The ",Object(i.b)("inlineCode",{parentName:"p"},"owner")," is an Ethereum address that consists of 20 bytes in a format of a hex string or  ",Object(i.b)("inlineCode",{parentName:"p"},"Uint8Array"),"."),Object(i.b)("div",{className:"admonition admonition-warning alert alert--danger"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"SOCs are immutable!")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},'You might be tempted to modify a SOC\'s content to "update" the chunk. Reuploading of SOC is forbidden in Swarm as it might create uncertain behavior. Bee node will reject the API call if it finds already existing SOC for the given address. Either use a different ',Object(i.b)("inlineCode",{parentName:"p"},"identifier"),", or you might be looking for Feeds as your use case."))),Object(i.b)("h3",{id:"reading-socs"},"Reading SOCs"),Object(i.b)("p",null,"To read data from a SOC, we need to make a reader object bound to a specific ",Object(i.b)("inlineCode",{parentName:"p"},"owner"),". Then we can download the data with the provided chunk's ",Object(i.b)("inlineCode",{parentName:"p"},"identifier"),"."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"const owner = '0x8d3766440f0d7b949a5e32995d09619a7f86e632'\nconst socReader = bee.makeSOCReader(owner)\nconst identifier = '0000000000000000000000000000000000000000000000000000000000000000'\nconst soc = await socReader.download(identifier)\nconst data = soc.payload()\n")),Object(i.b)("h3",{id:"writing-socs"},"Writing SOCs"),Object(i.b)("p",null,"When writing a SOC, first, we need to make a writer object. Because we need to sign the chunk, we need to pass in a ",Object(i.b)("inlineCode",{parentName:"p"},"signer")," object. The ",Object(i.b)("inlineCode",{parentName:"p"},"signer")," object can be either an Ethereum private key (as a hex string or ",Object(i.b)("inlineCode",{parentName:"p"},"Uint8Array"),") or an instance of the ",Object(i.b)("inlineCode",{parentName:"p"},"Signer")," interface. The ",Object(i.b)("inlineCode",{parentName:"p"},"Signer")," interface can be used for integration with 3rd party Ethereum wallet applications because Swarm uses the same format for signing chunks that Ethereum uses for signing transactions."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-ts"},"type SyncSigner = (digest: Uint8Array) => Signature\ntype AsyncSigner = (digest: Uint8Array) => Promise<Signature>\n\n/**\n * Interface for implementing Ethereum compatible signing.\n *\n * @property sign     The sign function that can be sync or async\n * @property address  The Ethereum address of the signer\n */\nexport type Signer = {\n  sign: SyncSigner | AsyncSigner\n  address: EthAddress\n}\n")),Object(i.b)("div",{className:"admonition admonition-warning alert alert--danger"},Object(i.b)("div",{parentName:"div",className:"admonition-heading"},Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",{parentName:"h5",className:"admonition-icon"},Object(i.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},Object(i.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Your communication privacy may be at risk")),Object(i.b)("div",{parentName:"div",className:"admonition-content"},Object(i.b)("p",{parentName:"div"},"We suggest using either ephemeral private keys (e.g. randomly generated) or the ",Object(i.b)("inlineCode",{parentName:"p"},"Signer")," interface when writing to SOC or Feeds. Never use your real Ethereum private keys here (or in any web applications really) directly because you may lose your funds stored on it."))),Object(i.b)("p",null,"Using the writer interface is similar to using the reader:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"const signer = '0x634fb5a872396d9693e5c9f9d7233cfa93f395c093371017ff44aa9ae6564cdd'\nconst socWriter = bee.makeSOCWriter(signer)\nconst identifier = '0000000000000000000000000000000000000000000000000000000000000000'\nconst data = new Uint8Array([1, 2, 3])\nconst response = await socWriter.upload(identifier, data)\n")),Object(i.b)("h2",{id:"feeds"},"Feeds"),Object(i.b)("p",null,"Feeds are an abstraction built on top of SOCs to provide mutable resources on the otherwise immutable data types that Swarm supports."),Object(i.b)("p",null,"One of the most common use cases for feeds is to store mutable data in an immutable address. For example, when hosting a website on Swarm, we may want its address stored in ENS, but we don't want to pay for changing the reference every time the site is updated."),Object(i.b)("p",null,"A feed is defined by its ",Object(i.b)("inlineCode",{parentName:"p"},"owner")," (see above), a ",Object(i.b)("inlineCode",{parentName:"p"},"topic")," (32 bytes arbitrary data as a hex string or ",Object(i.b)("inlineCode",{parentName:"p"},"Uint8Array"),"), and a ",Object(i.b)("inlineCode",{parentName:"p"},"type"),". ",Object(i.b)("inlineCode",{parentName:"p"},"type")," defines how the updates and lookup of the feed index are made (currently only the ",Object(i.b)("inlineCode",{parentName:"p"},"sequence")," type is supported)."),Object(i.b)("p",null,"The publisher is the owner of the feed, and only they can post updates to the feed. Posting an update requires (1) constructing the identifier from the topic and the correct index and (2) signing it concatenated together with the hash of the arbitrary content of the update."),Object(i.b)("p",null,"Conversely, users can consume a feed by retrieving the chunk by its address. Retrieving an update requires the consumer to construct the address from the owner\u2019s address and the identifier. To calculate the identifier, they need the topic and the appropriate index. For this, they need to know the indexing scheme."),Object(i.b)("p",null,"Feeds enable Swarm users to represent a sequence of content updates. The content of the update is the payload that the feed owner signs against the identifier. The payload can be a swarm reference from which the user can retrieve the associated data."),Object(i.b)("h3",{id:"topic"},"Topic"),Object(i.b)("p",null,"In Swarm, ",Object(i.b)("inlineCode",{parentName:"p"},"topic")," is a 32-byte long arbitrary byte array. It's possible to choose an arbitrary topic for each application, and then knowing someone's (or something's) address, it's possible to find their feeds. Also, this can be the hash of a human-readable string, specifying the topic and optionally the subtopic of the feed. There is a helper function provided for that:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"const topic = bee.makeFeedTopic('my-dapp.eth/outbox')\n")),Object(i.b)("h3",{id:"reading-feeds"},"Reading feeds"),Object(i.b)("p",null,"To read data from a feed, we need to make a reader object for a specific ",Object(i.b)("inlineCode",{parentName:"p"},"type"),", ",Object(i.b)("inlineCode",{parentName:"p"},"topic")," and ",Object(i.b)("inlineCode",{parentName:"p"},"owner"),", then we can download the latest update containing a reference."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"const topic = '0000000000000000000000000000000000000000000000000000000000000000'\nconst owner = '0x8d3766440f0d7b949a5e32995d09619a7f86e632'\nconst feedReader = bee.makeFeedReader('sequence', topic, owner)\nconst feedUpdate = await feedReader.download()\nconsole.log(feedUpdate.reference) // prints the latest reference stored in the feed\n")),Object(i.b)("h3",{id:"writing-feeds"},"Writing feeds"),Object(i.b)("p",null,"When writing a feed, typically an immutable content is uploaded first, and then its reference is updated in the feed. The ",Object(i.b)("inlineCode",{parentName:"p"},"signer")," here is the same as with ",Object(i.b)("a",{parentName:"p",href:"#writing-socs"},"writing the SOCs")," (with the same caveats!)."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"const data = new Uint8Array([1, 2, 3])\nconst reference = await bee.uploadData(data)\nconst topic = '0000000000000000000000000000000000000000000000000000000000000000'\nconst signer = '0x634fb5a872396d9693e5c9f9d7233cfa93f395c093371017ff44aa9ae6564cdd'\nconst feedWriter = bee.makeFeedWriter('sequence', topic, signer)\nconst response = await feedWriter.upload(reference)\n")),Object(i.b)("h3",{id:"using-feed-manifest"},"Using feed manifest"),Object(i.b)("p",null,"One of the most common use cases for feeds is to store mutable data in an immutable address. For example, when hosting a website on Swarm, we may want its address stored in ENS, but we don't want to pay for changing the reference every time the site is updated."),Object(i.b)("p",null,"Swarm provides a feature called ",Object(i.b)("inlineCode",{parentName:"p"},"feed manifests")," for this use case. It is a content-addressed chunk that stores a feed's definition (the ",Object(i.b)("inlineCode",{parentName:"p"},"type"),", the ",Object(i.b)("inlineCode",{parentName:"p"},"topic"),", and the ",Object(i.b)("inlineCode",{parentName:"p"},"owner"),"). When it is looked up using the ",Object(i.b)("inlineCode",{parentName:"p"},"bzz")," endpoint, Swarm recognizes that it refers to a feed and continues the lookup according to the feed parameters."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},"const topic = '0000000000000000000000000000000000000000000000000000000000000000'\nconst owner = '0x8d3766440f0d7b949a5e32995d09619a7f86e632'\nconst reference = bee.createFeedManifest('sequence', topic, owner)\n")),Object(i.b)("p",null,"This creates the feed manifest chunk on Swarm. You can use the returned reference to look up with the ",Object(i.b)("inlineCode",{parentName:"p"},"/bzz")," endpoint or use it with ENS."))}l.isMDXComponent=!0}}]);