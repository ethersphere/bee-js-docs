"use strict";(self.webpackChunkbee_js_docs=self.webpackChunkbee_js_docs||[]).push([[3807],{569:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"documentation/pinning","title":"Pinning","description":"Pinning allows you to guarantee that content will always be available by storing it locally on your own Bee node.","source":"@site/docs/documentation/pinning.md","sourceDirName":"documentation","slug":"/pinning","permalink":"/docs/pinning","draft":false,"unlisted":false,"editUrl":"https://github.com/ethersphere/bee-js-docs/docs/documentation/pinning.md","tags":[],"version":"current","frontMatter":{"title":"Pinning","id":"pinning","slug":"/pinning","sidebar_label":"Pinning"},"sidebar":"Balls","previous":{"title":"Tracking Uploads","permalink":"/docs/tracking-uploads"},"next":{"title":"Staking","permalink":"/docs/staking"}}');var s=i(4848),a=i(8453);const t={title:"Pinning",id:"pinning",slug:"/pinning",sidebar_label:"Pinning"},l=void 0,o={},c=[{value:"Pinning and Unpinning Content",id:"pinning-and-unpinning-content",level:2},{value:"Checking if a Reference is Retrievable",id:"checking-if-a-reference-is-retrievable",level:2},{value:"Reuploading Pinned Data",id:"reuploading-pinned-data",level:2},{value:"Listing All Pinned References",id:"listing-all-pinned-references",level:2},{value:"Example Script",id:"example-script",level:2}];function d(e){const n={code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Pinning allows you to guarantee that content will always be available by storing it ",(0,s.jsx)(n.strong,{children:"locally on your own Bee node"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["However, pinning ",(0,s.jsx)(n.em,{children:(0,s.jsx)(n.strong,{children:"does not"})})," guarantee availability across the Swarm network. Therefore you must use pinning along with the ",(0,s.jsx)(n.strong,{children:"stewardship utilities"})," included in ",(0,s.jsx)(n.code,{children:"bee-js"})," to monitor the availability of your pinned content and reupload it if needed."]}),"\n",(0,s.jsx)(n.p,{children:"In this section, you'll learn how to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Pin content"}),"\n",(0,s.jsx)(n.li,{children:"Check whether pinned content is still retrievable from the network"}),"\n",(0,s.jsx)(n.li,{children:"Reupload missing content"}),"\n",(0,s.jsx)(n.li,{children:"View all currently pinned references"}),"\n",(0,s.jsx)(n.li,{children:"Remove pins that are no longer required"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"pinning-and-unpinning-content",children:"Pinning and Unpinning Content"}),"\n",(0,s.jsx)(n.p,{children:"To pin a reference (so it remains stored on your node):"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"await bee.pin(reference)\nconsole.log('Reference pinned locally.')\n"})}),"\n",(0,s.jsx)(n.p,{children:"To stop tracking and remove it from local pin storage:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"await bee.unpin(reference)\nconsole.log('Reference unpinned and no longer tracked.')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"checking-if-a-reference-is-retrievable",children:"Checking if a Reference is Retrievable"}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"isReferenceRetrievable(reference)"})," to verify if the content for a given Swarm reference is currently accessible on the network:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const isAvailable = await bee.isReferenceRetrievable(reference)\n\nif (isAvailable) {\n  console.log('Data is retrievable from the network.')\n} else {\n  console.log('Data is missing from the network.')\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"reuploading-pinned-data",children:"Reuploading Pinned Data"}),"\n",(0,s.jsxs)(n.p,{children:["If content is missing but was previously pinned, you can reupload it using ",(0,s.jsx)(n.code,{children:"reuploadPinnedData(postageBatchId, reference)"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"await bee.reuploadPinnedData(postageBatchId, reference)\nconsole.log('Data has been reuploaded to the network.')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"listing-all-pinned-references",children:"Listing All Pinned References"}),"\n",(0,s.jsx)(n.p,{children:"You can get all currently pinned references with:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const pins = await bee.getAllPins()\nconsole.log('Pinned references:', pins.map(ref => ref.toHex()))\n"})}),"\n",(0,s.jsx)(n.p,{children:"To check if a specific reference is pinned:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const pinStatus = await bee.getPin(reference)\nconsole.log('Pin info:', pinStatus)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"example-script",children:"Example Script"}),"\n",(0,s.jsx)(n.p,{children:"The following script automates the process of checking all locally pinned references, verifying their retrievability from the network, and reuploading any that are missing. This ensures that your pinned data remains available even if it has dropped out of the Swarm network."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:'import { Bee } from "@ethersphere/bee-js"\n\nconst bee = new Bee(\'http://localhost:1633\')\nconst postageBatchId = "129903062bedc4eca6fc1c232ed385e93dda72f711caa1ead6018334dd801cee"\n\nasync function reuploadMissingPins() {\n  try {\n    // Get all currently pinned references\n    const pinnedRefs = await bee.getAllPins()\n\n    if (!pinnedRefs.length) {\n      console.log("No pinned references found.")\n      return\n    }\n\n    console.log(`Found ${pinnedRefs.length} pinned references.`)\n\n    let repaired = 0\n\n    // Loop through all references and check retrievability\n    for (const ref of pinnedRefs) {\n      const reference = ref.toHex()\n      const isAvailable = await bee.isReferenceRetrievable(reference)\n\n      if (isAvailable) {\n        console.log(`\u2705 ${reference} is retrievable.`)\n      } else {\n        console.log(`\u26a0\ufe0f  ${reference} is missing \u2014 reuploading...`)\n        await bee.reuploadPinnedData(postageBatchId, reference)\n        console.log(`\ud83d\udd01 Reuploaded ${reference}`)\n        repaired++\n      }\n    }\n\n    console.log(`\\nDone. ${repaired} reference(s) were reuploaded.`)\n  } catch (error) {\n    console.error("Error:", error.message)\n  }\n}\n\nreuploadMissingPins()\n'})}),"\n",(0,s.jsx)(n.p,{children:"Example terminal output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"Found 2 pinned references.\n\u26a0\ufe0f  1880ff0bbd23997dfa46921ba2ab0098824d967fe60c6ca1ae2e8fd722f4db78 is missing \u2014 reuploading...\n\ud83d\udd01 Reuploaded 1880ff0bbd23997dfa46921ba2ab0098824d967fe60c6ca1ae2e8fd722f4db78\n\u2705 fd79d5e0ebd8407e422f53ce1d7c4c41ebf403be55143900f8d1490560294780 is retrievable.\n\nDone. 1 reference(s) were reuploaded.\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var r=i(6540);const s={},a=r.createContext(s);function t(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);