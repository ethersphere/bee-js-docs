"use strict";(self.webpackChunkbee_js_docs=self.webpackChunkbee_js_docs||[]).push([[76],{1470:(e,t,a)=>{a.d(t,{A:()=>S});var n=a(8168),r=a(6540),s=a(53),o=a(3104),i=a(6347),l=a(7485),u=a(1682),c=a(9466);function d(e){return function(e){return r.Children.map(e,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))}(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:r}}=e;return{value:t,label:a,attributes:n,default:r}}))}function p(e){const{values:t,children:a}=e;return(0,r.useMemo)((()=>{const e=t??d(a);return function(e){const t=(0,u.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function m(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function g(e){let{queryString:t=!1,groupId:a}=e;const n=(0,i.W6)(),s=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,l.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(n.location.search);t.set(s,e),n.replace({...n.location,search:t.toString()})}),[s,n])]}function y(e){const{defaultValue:t,queryString:a=!1,groupId:n}=e,s=p(e),[o,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:s}))),[l,u]=g({queryString:a,groupId:n}),[d,y]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,s]=(0,c.Dv)(a);return[n,(0,r.useCallback)((e=>{a&&s.set(e)}),[a,s])]}({groupId:n}),b=(()=>{const e=l??d;return m({value:e,tabValues:s})?e:null})();(0,r.useLayoutEffect)((()=>{b&&i(b)}),[b]);return{selectedValue:o,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),y(e)}),[u,y,s]),tabValues:s}}var b=a(2303);const h={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function f(e){let{className:t,block:a,selectedValue:i,selectValue:l,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.a_)(),p=e=>{const t=e.currentTarget,a=c.indexOf(t),n=u[a].value;n!==i&&(d(t),l(n))},m=e=>{let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const a=c.indexOf(e.currentTarget)+1;t=c[a]??c[0];break}case"ArrowLeft":{const a=c.indexOf(e.currentTarget)-1;t=c[a]??c[c.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":a},t)},u.map((e=>{let{value:t,label:a,attributes:o}=e;return r.createElement("li",(0,n.A)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>c.push(e),onKeyDown:m,onClick:p},o,{className:(0,s.A)("tabs__item",h.tabItem,o?.className,{"tabs__item--active":i===t})}),a??t)})))}function v(e){let{lazy:t,children:a,selectedValue:n}=e;if(a=Array.isArray(a)?a:[a],t){const e=a.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},a.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function w(e){const t=y(e);return r.createElement("div",{className:(0,s.A)("tabs-container",h.tabList)},r.createElement(f,(0,n.A)({},e,t)),r.createElement(v,(0,n.A)({},e,t)))}function S(e){const t=(0,b.A)();return r.createElement(w,(0,n.A)({key:String(t)},e))}},1701:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>g,frontMatter:()=>i,metadata:()=>u,toc:()=>d});var n=a(8168),r=(a(6540),a(5680)),s=a(1470),o=a(9365);const i={title:"Postal Service over Swarm",id:"pss",slug:"/pss",sidebar_label:"Postal Service over Swarm"},l=void 0,u={unversionedId:"documentation/pss",id:"documentation/pss",title:"Postal Service over Swarm",description:"\ud83d\udea7 Under Construction \ud83d\udea7",source:"@site/docs/documentation/pss.md",sourceDirName:"documentation",slug:"/pss",permalink:"/docs/pss",draft:!1,editUrl:"https://github.com/ethersphere/bee-js-docs/docs/documentation/pss.md",tags:[],version:"current",frontMatter:{title:"Postal Service over Swarm",id:"pss",slug:"/pss",sidebar_label:"Postal Service over Swarm"}},c={},d=[{value:"\ud83d\udea7 Under Construction \ud83d\udea7",id:"-under-construction-",level:2},{value:"Getting the relevant data",id:"getting-the-relevant-data",level:2},{value:"Sending message",id:"sending-message",level:2},{value:"Retrieving message",id:"retrieving-message",level:2}],p={toc:d},m="wrapper";function g(e){let{components:t,...a}=e;return(0,r.yg)(m,(0,n.A)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h2",{id:"-under-construction-"},"\ud83d\udea7 Under Construction \ud83d\udea7"),(0,r.yg)("admonition",{title:"\ud83d\udea7 This page is under construction",type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"This section is still being worked on. Check back soon for updates!")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Remove the unrelated intro section"),(0,r.yg)("li",{parentName:"ul"},"Show a listener"),(0,r.yg)("li",{parentName:"ul"},"Show a one time receive"),(0,r.yg)("li",{parentName:"ul"},"Show a send invocation"),(0,r.yg)("li",{parentName:"ul"},"Move it towards the end of the chapters, it is not very important")),(0,r.yg)("p",null,"Swarm provides the ability to send messages that appear to be normal Swarm traffic, but are in fact messages that may be received and decrypted to reveal their content only to specific nodes that were intended to receive them."),(0,r.yg)("p",null,"PSS provides a pub-sub facility that can be used for a variety of tasks. Nodes are able to listen to messages received for a specific topic in their nearest neighbourhood and create messages destined for another neighbourhood which are sent over the network using Swarm's usual data dissemination protocols."),(0,r.yg)("p",null,"The intended use of PSS is to communicate privately with a publicly known identity (to for example initiate further communication directly). Due to the cost of mining the trojan chunks, it is not recommended to use as an instant messaging system."),(0,r.yg)("admonition",{title:"Light nodes are unreachable",type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"Be aware! You can not send message to Light nodes! This is because light nodes does not fully participate\nin the data exchange in Swarm network and hence the message won't arrive to them.")),(0,r.yg)("h2",{id:"getting-the-relevant-data"},"Getting the relevant data"),(0,r.yg)("p",null,"When you start ",(0,r.yg)("inlineCode",{parentName:"p"},"bee"),", you may find all the necessary information in the log:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-sh"},"INFO using existing swarm network address: 9e2ebf266369090091620db013aab164afb1574aedb3fcc08ce8dc6e6f28ef54 \nINFO swarm public key 03e0cee7e979fa99350fc2e2f8c81d857b525b710380f238742af269bb794dfd3c                        \nINFO pss public key 02fa24cac43531176d21678900b37bd800c93da3b02c5e11572fb6a96ec49527fa \nINFO using ethereum address 5f5505033e3b985b88e20616d95201596b463c9a \n")),(0,r.yg)("p",null,"Let's break it down:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Ethereum address")," is the public address of your node wallet. Together with the corresponding private key, it is used for things such as making Ethereum transactions (receiving and sending ETH and BZZ); receiving, claiming and singing cheques and the Swarm network address is also derived from it."),(0,r.yg)("li",{parentName:"ul"},"The ",(0,r.yg)("strong",{parentName:"li"},"Swarm network address")," defines your location in the kademlia and within the context of PSS is used for addressing the trojan chunks to you. In other words, others may use it to send you a message."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"PSS public key")," can be used by others to encrypt their messages for you.")),(0,r.yg)("h2",{id:"sending-message"},"Sending message"),(0,r.yg)("p",null,"To send data simply define a topic, prefix of the recipient's swarm network address (we recommend 4-6 character prefix length) and the data to be send."),(0,r.yg)("admonition",{title:"Your communication privacy may be at risk",type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"When sending PSS messages without encryption key, any Bee node through which the trojan chunk passes would be able to read the message.")),(0,r.yg)(s.A,{groupId:"lang_preferrence",defaultValue:"ts",values:[{label:"TypeScript",value:"ts"},{label:"JavaScript",value:"js"}],mdxType:"Tabs"},(0,r.yg)(o.A,{value:"ts",mdxType:"TabItem"},(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-ts"},"/**\n * @param {string}            topic\n * @param {string}            targetPrefix\n * @param {string|Uint8Array} data\n * @param {string}            encryptionKey\n */\nbee.pssSend('topic', '9e2e', 'Hello!')\n"))),(0,r.yg)(o.A,{value:"js",mdxType:"TabItem"},(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"/**\n * @param {string}            topic\n * @param {string}            targetPrefix\n * @param {string|Uint8Array} data\n * @param {string}            encryptionKey\n */\nbee.pssSend('topic', '9e2e', 'Hello!')\n")))),(0,r.yg)("p",null,"If you want to encrypt the message, you may provide the recipient's PSS public key."),(0,r.yg)(s.A,{groupId:"lang_preferrence",defaultValue:"ts",values:[{label:"TypeScript",value:"ts"},{label:"JavaScript",value:"js"}],mdxType:"Tabs"},(0,r.yg)(o.A,{value:"ts",mdxType:"TabItem"},(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-ts"},"bee.pssSend(\n  'topic',\n  '9e2e',\n  'Encrypted Hello!',\n  '02fa24cac43531176d21678900b37bd800c93da3b02c5e11572fb6a96ec49527fa',\n)\n"))),(0,r.yg)(o.A,{value:"js",mdxType:"TabItem"},(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"bee.pssSend(\n  'topic',\n  '9e2e',\n  'Encrypted Hello!',\n  '02fa24cac43531176d21678900b37bd800c93da3b02c5e11572fb6a96ec49527fa',\n)\n")))),(0,r.yg)("h2",{id:"retrieving-message"},"Retrieving message"),(0,r.yg)("p",null,"As a recipient, you have two ways how to receive the message. If you are expecting one off message (which is the intended PSS use case to exchange credentials for further direct communication), you can use the ",(0,r.yg)("inlineCode",{parentName:"p"},"pssReceive")," method."),(0,r.yg)(s.A,{groupId:"lang_preferrence",defaultValue:"ts",values:[{label:"TypeScript",value:"ts"},{label:"JavaScript",value:"js"}],mdxType:"Tabs"},(0,r.yg)(o.A,{value:"ts",mdxType:"TabItem"},(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-ts"},"const message = await bee.pssReceive('topic')\n\nconsole.log(message.text()) // prints the received message\n"))),(0,r.yg)(o.A,{value:"js",mdxType:"TabItem"},(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"const message = await bee.pssReceive('topic')\n\nconsole.log(message.text()) // prints the received message\n")))),(0,r.yg)("p",null,"If you want to subscribe to multiple messagees, use the ",(0,r.yg)("inlineCode",{parentName:"p"},"pssSubscribe")," method."),(0,r.yg)(s.A,{groupId:"lang_preferrence",defaultValue:"ts",values:[{label:"TypeScript",value:"ts"},{label:"JavaScript",value:"js"}],mdxType:"Tabs"},(0,r.yg)(o.A,{value:"ts",mdxType:"TabItem"},(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-ts"},"const handler = {\n  onMessage: (message: Data) => {console.log(message.text())},\n  onError: (error: BeeError) => {console.log(error)}\n}\n\n// Subscribe\nconst subscription = bee.pssSubscribe('topic', handler)\n\n// Terminate the subscription\nsubscription.cancel()\n"))),(0,r.yg)(o.A,{value:"js",mdxType:"TabItem"},(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-js"},"const handler = {\n  onMessage: (message) => {console.log(message.text())},\n  onError: (error) => {console.log(error)}\n}\n\n// Subscribe\nconst subscription = bee.pssSubscribe('topic', handler)\n\n// Terminate the subscription\nsubscription.cancel()\n")))))}g.isMDXComponent=!0},5680:(e,t,a)=>{a.d(t,{xA:()=>c,yg:()=>g});var n=a(6540);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=u(a),m=r,g=d["".concat(l,".").concat(m)]||d[m]||p[m]||s;return a?n.createElement(g,o(o({ref:t},c),{},{components:a})):n.createElement(g,o({ref:t},c))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=a.length,o=new Array(s);o[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var u=2;u<s;u++)o[u]=a[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},9365:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(6540),r=a(53);const s={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:a,className:o}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,o),hidden:a},t)}}}]);